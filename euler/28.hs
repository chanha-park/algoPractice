{-# OPTIONS_GHC -Wall -Wextra -Werror #-}

main :: IO ()
main = print . spiralDiagonalSum . (`div` 2) . (+ 1) $ 1001

spiralDiagonalSum :: Int -> Int
spiralDiagonalSum n = div (2 * n * (n * (8 * n - 9) + 7)) 3 - 3

-- 1
-- 3	5	7	9
-- 13	17	21	25
-- 31	37	43	49
-- 57	65	73	81

-- s(1) = 1
-- s(3) = s(1) + (1 + 2 * 1) + (1 + 2 * 2) + ... + (1 + 2 * 4)
-- s(5) = s(3) + (9 + 4 * 1) + (9 + 4 * 2) + ... + (9 + 4 * 4)
-- s(7) = s(5) + (25 + 6 * 1) + (25 + 6 * 2) + ... + (25 + 6 * 4)

-- s(n + 2) = s(n) + 4 * n * n + (n + 1) * 10
--
--
-- a(1) = 1
-- a(n) = s(2n - 1) = s(2n - 3) + 4 * (2n - 3) ^ 2 + (2n - 2) * 10
--                  = a(n - 1) + 16n ^ 2 - 28n + 16
--                  = 1 + 16(n(n + 1)(2n + 1)/6 - 1) - 28(n(n + 1)/2 - 1) + 16(n - 1)
--                  = (2 * n * (n * (8 * n - 9) + 7)) / 3 - 3
